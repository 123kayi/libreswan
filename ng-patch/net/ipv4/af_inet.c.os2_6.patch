commit c0f13aeb0d3eaeac192a7186d678c9b8a635643a
Author: Michael Richardson <mcr@xelerance.com>
Date:   Tue Apr 25 20:50:28 2006 -0400

    KLIPSng patches to rest of kernel.
    Sign-off-by: Michael Richardson <mcr@xelerance.com>

diff --git a/include/linux/in.h b/include/linux/in.h
index ba35538..2b47dff 100644
--- a/include/linux/in.h
+++ b/include/linux/in.h
@@ -1222,6 +1222,18 @@ static int __init inet_init(void)
 #if defined(CONFIG_IP_MROUTE)
 	ip_mr_init();
 #endif
+
+#if defined(CONFIG_KLIPS)
+	{
+               extern int ipsec_klips_init(void);
+		/*
+		 *  Initialise AF_INET ESP and AH protocol support including 
+		 *  e-routing and SA tables
+		 */
+		ipsec_klips_init();
+	}
+#endif /* CONFIG_IPSEC */
+
 	/*
 	 *	Initialise per-cpu ipv4 mibs
 	 */ 
diff --git a/net/ipv4/fib_rules.c b/net/ipv4/fib_rules.c
index 0dd4d06..2a6e776 100644
--- a/net/ipv4/fib_rules.c
