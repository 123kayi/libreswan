commit c0f13aeb0d3eaeac192a7186d678c9b8a635643a
Author: Michael Richardson <mcr@xelerance.com>
Date:   Tue Apr 25 20:50:28 2006 -0400

    KLIPSng patches to rest of kernel.
    Sign-off-by: Michael Richardson <mcr@xelerance.com>

diff --git a/include/linux/in.h b/include/linux/in.h
index ba35538..2b47dff 100644
--- a/include/linux/in.h
+++ b/include/linux/in.h
@@ -382,8 +397,10 @@ static __inline__ int inet_fill_rule(struct sk_buff *skb,
 	rtm->rtm_src_len = r->r_src_len;
 	rtm->rtm_tos = r->r_tos;
 #ifdef CONFIG_IP_ROUTE_FWMARK
-	if (r->r_fwmark)
-		RTA_PUT(skb, RTA_PROTOINFO, 4, &r->r_fwmark);
+	if (r->r_fwmark) {
+		RTA_PUT(skb, RTA_FWMARK, 4, &r->r_fwmark);
+		RTA_PUT(skb, RTA_FWMARK_MASK, 4, &r->r_fwmark_mask);
+	}
 #endif
 	rtm->rtm_table = r->r_table;
 	rtm->rtm_protocol = 0;
diff --git a/net/ipv4/fib_semantics.c b/net/ipv4/fib_semantics.c
index 0f4145b..2265232 100644
--- a/net/ipv4/fib_semantics.c
