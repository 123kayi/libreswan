
CVE-2010-3308 Libreswan cisco banner option handling vulnerability
http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2010-3308

See also: CVE-2010-3302: Libreswan cisco DNS option handling vulnerability
http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2010-3302

Security Alert:
This alert (and any possible updates) is available at the following URL:
http://www.libreswan.org/download/CVE-2010-3302/

The Libreswan project has discovered two vulnerabilities in the XAUTH
Cisco handling code that could be exploited if libreswan connects to a
trusted gateway that has been compromised.

Vulnerable versions: libreswan 2.6.26 up to and including libreswan 2.6.28
Fixed version      : libreswan 2.6.29 and above

Vulnerability information:
In very specific circumstances, a buffer overflow and arbitrary shell
commands could be sent to a vulnerable libreswan client.

These vulnerabilities can only be triggered when libreswan is configured to
connect to a malicious Cisco compatible gateway using XAUTH. It requires
libreswan to be configured with *xauthclient=yes and remote_peer_type=cisco,
and requires successful phase1 IKE negotiation. This can only happen to a
vulnerable Libreswan client when connecting to a trusted and authenticated
gateway using XAUTH.

An Libreswan server receiving VPN connections is not affected by this flaw.

Vulnerability Details:
The field cisco_banner (later renamed to server_banner) were declared as a
fixed length buffer. If a banner is sent with more then 500 characters,
the buffer will overflow.  Additionally, the banner was copied
into fmt_common_shell_out() without being sanitized to make it safe
against exploitable characters, such as single quotes('). This was
introduced in git commit id 3615e17463a, on May 19, 2010 and first
released in libreswan 2.6.26.

Patch:
For those unable to upgrade to the latest libreswan 2.6.29 release, a patch
addressing CVE-2010-3308 and CVE-2010-3302 can be found at:
http://www.libreswan.org/download/CVE-2010-3308/

Full release:
The latest libreswan release which fixes all known issues can be found at:
http://www.libreswan.org/download/libreswan-2.6.29.tar.gz
http://www.libreswan.org/download/libreswan-2.6.29.tar.gz.asc (GPG signature)

Credit:
These vulnerabilities were found by D. Hugh Redelmeier <hugh@mimosa.com>
and Paul Wouters <paul@xelerance.com>

About libreswan (http://www.libreswan.org/):
Libreswan is a free implementation of Internet Protocol Security (IPsec)
and Internet Key Exchange (IKE). IPsec uses strong cryptography to provide
both authentication and encryption services. These services allow you to
build secure tunnels through untrusted networks. Everything passing through
the untrusted network is encrypted by the IPsec gateway machine, and
decrypted by the gateway at the other end of the tunnel. The resulting
tunnel is a virtual private network (VPN).

About Xelerance (http://www.xelerance.com/):
Xelerance is the custodian of the libreswan IPsec software and the L2TP
server xl2tpd. These are used in combination to provide Enterprise VPN
solutions.  Headquartered in Ottawa, the high-tech capital of Canada,
Xelerance provides products and services to secure the internet. Its
products include DNSX Secure Signer, which won the Best Security Hardware
award at FOSE 2010, and DNSX Secure Resolver.
