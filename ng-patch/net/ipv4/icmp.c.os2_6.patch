*** net/ipv4/icmp.c.orig	2008-03-27 21:15:02.000000000 -0400
--- net/ipv4/icmp.c	2006-04-25 22:40:09.000000000 -0400
***************
*** 384,389 ****
--- 384,391 ----
  	struct rtable *rt = (struct rtable *)skb->dst;
  	u32 daddr;
  
+ 	memset(&ipc, 0, sizeof(ipc));
+ 
  	if (ip_options_echo(&icmp_param->replyopts, skb))
  		return;
  
***************
*** 440,445 ****
--- 442,449 ----
  	u32 saddr;
  	u8  tos;
  
+ 	memset(&ipc, 0, sizeof(ipc));
+ 
  	if (!rt)
  		goto out;
  
