commit c0f13aeb0d3eaeac192a7186d678c9b8a635643a
Author: Michael Richardson <mcr@xelerance.com>
Date:   Tue Apr 25 20:50:28 2006 -0400

    KLIPSng patches to rest of kernel.
    Sign-off-by: Michael Richardson <mcr@xelerance.com>

diff --git a/include/linux/in.h b/include/linux/in.h
index ba35538..2b47dff 100644
--- a/include/linux/in.h
+++ b/include/linux/in.h
@@ -587,13 +587,19 @@ struct sec_decap_state {
 	struct xfrm_decap_state decap;
 };
 
+typedef unsigned int xfrm_sec_unique_t;
+
 struct sec_path
 {
 	atomic_t		refcnt;
+	xfrm_sec_unique_t       ref;       /*reference to high-level policy*/
 	int			len;
 	struct sec_decap_state	x[XFRM_MAX_DEPTH];
 };
 
+struct ipcm_cookie;
+extern int ip_cmsg_send_ipsec(struct cmsghdr *cmsg, struct ipcm_cookie *ipc);
+
 static inline struct sec_path *
 secpath_get(struct sec_path *sp)
 {
diff --git a/net/ipv4/Kconfig b/net/ipv4/Kconfig
index 011cca7..145d8f8 100644
--- a/net/ipv4/Kconfig
